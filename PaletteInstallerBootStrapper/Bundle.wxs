<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
	<Bundle Name="PaletteBootstrapperExe" Version="1.1" Manufacturer="Palette Software" UpgradeCode="59f5fcd9-629d-4af5-af13-6a9a49dfe836">
		<!--Default License-->
    <!--<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense" />-->
    <!--No License-->
    <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.HyperlinkLicense" />
    <WixVariable Id="WixStdbaLicenseUrl" Value="" />
    <!--Custom License-->
    <!--<BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.HyperlinkLicense">
      <Payload SourceFile="Resource\License.htm" />
    </BootstrapperApplicationRef>
    <WixVariable Id="WixStdbaLicenseUrl" Value="License.htm" />-->

    <Chain>
      <!-- TODO: Define the list of chained packages. -->
      <!-- <MsiPackage SourceFile="path\to\your.msi" /> -->
      <!--<MsiPackage Id="DotNet35" SourceFile="..\dotnet35\NETCFSetupv35.msi" 
                  InstallCondition="NOT Installed AND NOT NETFRAMEWORK35"
                  ForcePerMachine="yes"/>-->
      <!--<PackageGroupRef Id="Netfx35" />-->
      <MsiPackage Id="Palette" SourceFile="..\PaletteInstaller\bin\$(var.Configuration)\PaletteInstaller.msi" DisplayInternalUI="yes"/>
    </Chain>
    
  </Bundle>
  <Fragment>
    <util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v3.5" Value="Version" Variable="Netfx35Version" />
    <PackageGroup Id="Netfx35">
      <ExePackage Id="Netfx35"
        Cache="no"
        Compressed="yes"
        PerMachine="yes"
        Permanent="yes"
        Vital="yes"
        Name="NETCFSetupv35.msi"
        SourceFile="..\dotnet35\NETCFSetupv35.msi"
        InstallCommand="/q /norestart /lang:ENU"
        RepairCommand="/q /norestart /lang:ENU"
        UninstallCommand="/q /norestart /lang:ENU"
        InstallCondition="NOT Netfx35Version OR (Netfx35Version &lt; v3.5.30729.1)"
        DetectCondition="Netfx35Version AND (Netfx35Version &gt;= v3.5.30729.1)">
        <ExitCode Value ="3010" Behavior="forceReboot" />
      </ExePackage>
    </PackageGroup>
  </Fragment>  
</Wix>